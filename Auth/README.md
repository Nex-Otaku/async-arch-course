# Сервис авторизации

В сервисе авторизации хранятся аккаунты и роли для всех пользователей системы.

**Операции которые возможны в сервисе:**

1. Зарегистрировать пользователя
2. Удалить пользователя
3. Узнать залогинен пользователь или нет - по токену
4. Узнать роль пользователя по публичному ключу аккаунта
5. Залогиниться
6. Разлогиниться

Авторизация в сервисах системы похожа по схеме работы с oAuth.

**Рассмотрим на примере действия "Завершить задачу".**

1. Пользователь отправляет запрос к таск-трекеру на завершение задачи.

1. Таск-трекер получает запрос от пользователя. В запросе содержится токен.

1. Если токена нет, отправляем пользователя на страницу авторизации - за которую будет отвечать сервис авторизации.

1. Если токен указан, таск-трекер отправляет токен в сервис авторизации и узнаёт, залогинен пользователь или нет. Если нет - перенаправляем на страницу логина.

1. Если пользователь залогинен, таск-трекер спрашивает у сервиса авторизации какая у пользователя роль. 

1. Если роль позволяет выполнить действие, то выполняем, иначе выдаём пользователю ошибку "Доступ запрещён".

Все обращения к сервису авторизации выполняются синхронно, пока нагрузка это позволяет. 

Когда нагрузка вырастет, то можно оптимизировать запросы по принципу Read Model, вариантов очень много.